# contents:
#
# Copyright Â© 2005 Nikolai Weibull <nikolai@bitwi.se>



require 'aux'

class TC_UpAndOutDirective < Test::Unit::TestCase
  def_format_test :test_01, "~{X ~A~^ Y ~A~^ ~}", [[1, 2, 3, 4, 5]], "X 1 Y 2 X 3 Y 4 X 5"

  def_format_test :test_02, "~{X ~A~^ Y ~A~^ ~}", [[1, 2, 3, 4]], "X 1 Y 2 X 3 Y 4"

  def_format_test :test_03, "~1{~A~^~A~}", [[1]], "1"

  def_format_test :test_04, "~0{~A~^~A~}", [[1]], ""

  def_format_test :test_05, "~1{~A~^~A~}", [[1, 2, 3]], "12"

  def_format_test :test_06, "~{~A~A~0^~A~}", [[1, 2, 3, 4, 5, 6]], "12"

  def_format_test :test_07, "~{~A~A~v^~A~}", [[1, 2, 3, 4, 5, 6, 0, 7, 8, 9, 10, 11, 12]], "12456"

  def_format_test :test_08, "~{~#,3^~A~}", [[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]], "1234567"

  def_format_test :test_09, "~{~2,#^~A~}~A", [[1, 2, 3, 4, 5, 6, 7, 8, 9, 10], 0], "123456780"

  def_format_test :test_10, "~{~#,#^~A~}", [[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]], ""

  def_format_test :test_11, "~{~#,#,#^~A~}", [[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]], ""

  def_format_test :test_12, "~{~#,1,2^~A~}", [[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]], "123456789"

  def_format_test :test_13, "~{~#,#,v^~A~}", [[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]], "246"

  def_format_test :test_14, "~{~#,#,v^~A~}", [[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]], "246"

  def_format_test :test_15, "~{~#,#,v^~A~}", [[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]], "246"

  def_format_test :test_16, "~{~#,#,v^~A~}", [[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]], "246"

  def_format_test :test_17, "~{~#,#,v^~A~}", [[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]], "2468"

  def_format_test :test_18, "~{~v,v^~A~}", [[Fixnum::MAX + 1, Fixnum::MAX + 1, 1]], ""

  def_format_test :test_19, "~{~0,v,v^~A~}", [[Fixnum::MAX + 1, Fixnum::MAX + 1, 1]], ""

  def_format_test :test_20, "~{~0,v,v^~A~}", [[Fixnum::MAX + 1, Fixnum::MAX, 1]], "1"

  def_format_test :test_21, "~{~1,v^~A~}", [[nil, 8, nil, 7, 0, 6, 1, 5]], "876"

  def_format_test :test_22, "~{~0,v^~A~}", [[3, 8, 1, 7, 3, 6, nil, 5]], "876"

  def_format_test :test_23, "~{~1,2,v^~A~}", [[0, 1, 0, 2, 0, 3, 3, 4]], "123"

  def_format_test :test_24, "~{~1,2,v^~A~}", [[0, 1, 0, 2, 0, 3, nil, 4]], "1234"

  def_format_test :test_25, "~{~1,1,v^~A~}", [[0, 1, 0, 2, 0, 3, nil, 4]], "123"

  def_format_test :test_26, "~{~'X^~A~}", [[1, 2, 3]], "123"

  def_format_test :test_27, "~{~v,'X^~A~}", [[0, 1, 'x', 2, nil, 3, 'X', 4, 0, 5]], "123"

  def_format_test :test_28, "~{~'X,v^~A~}", [[0, 1, 'x', 2, nil, 3, 'X', 4, 0, 5]], "123"

  def_format_test :test_29, "~{~v,v^~A~}", [[0, 2, 1, 'x', 'X', 2, 5, 'X', 3, 'y', 'y', 4, 1, 2, 5]], "123"

  def_format_test :test_30, "~{~',,',^~A~}", [[1, 2, 3]], ""

  def_format_test :test_31, "~{~1,v,v^~A~}", [['a', nil, 0]], "0"

  def_format_test :test_32, "~{~v,1,v^~A~}", [['a', nil, 0]], "0"

  def_format_test :test_33, "~{~v,v,v^~A~}", [['a', 'a', nil, 0]], ""

  # ~^ with ~:{

  def_format_test :test_34, "~:{~A~^~A~A~}", [[[1], [2, 3, 4], [5, 6, 7, 8]]], "1234567"

  def_format_test :test_35, "~:{~A~0^~A~A~}", [[[1], [2, 3, 4], [5, 6, 7, 8]]], "125"

  def_format_test :test_36, "~:{~#^~A~}", [[[1], [2, 3, 4], [], [5, 6, 7, 8]], []], "125"

  def_format_test :test_37, "~:{~#^~A~#^~A~#^~A~#^~A~}", [[[1], [2, 3, 4], [], [5, 6, 7, 8]], []], "12345678"

  def_format_test :test_38, "~:{~v^~A~}", [[[1, 2, 3], [0], [2, 4], [0, 5], [1, 6, 7, 8]]], "246"

  def_format_test :test_39, "~:{~v^~A~}", [[[nil], [nil, 1], [1, 2]]], "12"

  def_format_test :test_40, "~:{~v^~A~}", [[['x', 1], ['y', 2], [0, 3], [1, 4]]], "124"

  def_format_test :test_41, "~:{~v,3^~A~}", [[[1, 1], [2, 0], [3, 4], [5, 6]]], "106"

  def_format_test :test_42, "~:{~3,v^~A~}", [[[1, 1], [2, 0], [3, 4], [5, 6]]], "106"

  def_format_test :test_43, "~:{~v,3^~A~}", [[['x', 1]]], "1"

  def_format_test :test_44, "~:{~2,v^~A~}", [[['x', 1]]], "1"

  def_format_test :test_45, "~:{~v,v^~A~}", [[[1, 2, 0], [0, 1, 1], [1, 0, 2], [3, 3, 5], [4, 5, 6]]], "0126"

  def_format_test :test_46, "~:{~v,v^~A~}", [[[1, 2, 0], ['a', 'A', 1], ['A', 'A', 2], [1, 2, 3]]], "013"

  def_format_test :test_47, "~:{~'x,3^~A~}", [[[1]]], "1"

  def_format_test :test_48, "~:{~3,'x^~A~}", [[[1]]], "1"

  def_format_test :test_49, "~:{~'x,'x^~A~}", [[[1]]], ""

  def_format_test :test_50, "~:{~#,1^~A~}", [[[1], [2, 10], [3, :a, :b], [4], [5, :x], [6], [7, 8]]], "2357"

  def_format_test :test_51, "~:{~1,#^~A~}", [[[1], [2, 10], [3, :a, :b], [4], [5, :x], [6], [7, 8]]], "2357"

  def_format_test :test_52, "~:{~#,#^~A~}", [[[1], [], [2, 10], [3, :a, :b], [4], [5, :x], [6], [7, 8]]], ""

  def_format_test :test_53, "~:{~0,v^~A~}", [[[0, 1], [1, 2], [nil, 3], [2, 4]]], "24"

  def_format_test :test_54, "~:{~1,v^~A~}", [[[0, 1], [1, 2], [nil, 3], [2, 4]]], "134"

  def_format_test :test_55, "~:{~1,1,1^~A~}", [[[1], [2, 3], [4, 5, 6], [7, 8, 9, 0]]], ""

  def_format_test :test_56, "~:{~1,2,3^~A~}", [[[1], [2, 3], [4, 5, 6], [7, 8, 9, 0]]], ""

  def_format_test :test_57, "~:{~1,2,1^~A~}", [[[1], [2, 3], [4, 5, 6], [7, 8, 9, 0]]], "1247"

  def_format_test :test_58, "~:{~1,0,1^~A~}", [[[1], [2, 3], [4, 5, 6], [7, 8, 9, 0]]], "1247"

  def_format_test :test_59, "~:{~3,2,1^~A~}", [[[1], [2, 3], [4, 5, 6], [7, 8, 9, 0]]], "1247"

  def_format_test :test_60, "~:{~v,2,3^~A~}", [[[1, 10], [2, 20], [3, 30], [4, 40]]], "3040"

  def_format_test :test_61, "~:{~1,v,3^~A~}", [[[0, 7], [1, 10], [2, 20], [3, 30], [4, 40]]], "740"

  def_format_test :test_62, "~:{~1,2,v^~A~}", [[[0, 0], [1, 10], [2, 20], [3, 30], [4, 40], [0, 50]]], "01050"

  def_format_test :test_63, "~:{~1,2,v^~A~}", [[[nil, 0]]], "0"

  def_format_test :test_64, "~:{~#,3,3^~A~}", [[[1], [2, 1], [3, 2, 1], [4, 3, 2, 1], [5, 4, 3, 2, 1]]], "45"

  def_format_test :test_65, "~:{~2,#,3^~A~}", [[[1], [2, 1], [3, 2, 1], [4, 3, 2, 1], [5, 4, 3, 2, 1]]], "145"

  def_format_test :test_66, "~:{~0,3,#^~A~}", [[[1], [2, 1], [3, 2, 1], [4, 3, 2, 1], [5, 4, 3, 2, 1]]], "12"

  def_format_test :test_67, "~:{~#,#,3^~A~}", [[[1], [2, 1], [3, 2, 1], [4, 3, 2, 1], [5, 4, 3, 2, 1]]], "45"

  def_format_test :test_68, "~:{~3,#,#^~A~}", [[[1], [2, 1], [3, 2, 1], [4, 3, 2, 1], [5, 4, 3, 2, 1]]], "12"

  def_format_test :test_69, "~:{~#,3,#^~A~}", [[[1], [2, 1], [3, 2, 1], [4, 3, 2, 1], [5, 4, 3, 2, 1]]], "1245"

  def_format_test :test_70, "~:{~#,#,#^~A~}", [[[1], [2, 1], [3, 2, 1], [4, 3, 2, 1], [5, 4, 3, 2, 1]]], ""

  def_format_test :test_71, "~:{~1,v,v^~A~}", [[['a', nil, 0]]], "0"

  def_format_test :test_72, "~:{~v,1,v^~A~}", [[['a', nil, 0]]], "0"

  # Tests of ~^ inside ~@{ ... ~}

  def_format_test :test_73, "~@{X ~A~^ Y ~A~^ ~}", [1, 2, 3, 4, 5], "X 1 Y 2 X 3 Y 4 X 5"

  def_format_test :test_74, "~@{X ~A~^ Y ~A~^ ~}", [1, 2, 3, 4], "X 1 Y 2 X 3 Y 4"

  def_format_test :test_75, "~1@{~A~^~A~}", [1], "1"

  def_format_test :test_76, "~0@{~A~^~A~}", [1], ""

  def_format_test :test_77, "~1@{~A~^~A~}", [1, 2, 3], "12"

  def_format_test :test_78, "~@{~A~A~0^~A~}", [1, 2, 3, 4, 5, 6], "12"

  def_format_test :test_79, "~@{~A~A~v^~A~}", [1, 2, 3, 4, 5, 6, 0, 7, 8, 9, 10, 11, 12], "12456"

  def_format_test :test_80, "~@{~#,3^~A~}", [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "1234567"

  def_format_test :test_81, "~@{~2,#^~A~}X~A", [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "12345678X9"

  def_format_test :test_82, "~@{~#,#^~A~}", [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], ""

  def_format_test :test_83, "~@{~#,#,#^~A~}", [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], ""

  def_format_test :test_84, "~@{~#,1,2^~A~}", [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "123456789"

  def_format_test :test_85, "~@{~#,#,v^~A~}", [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "246"

  def_format_test :test_86, "~@{~#,#,v^~A~}", [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], "246"

  def_format_test :test_87, "~@{~#,#,v^~A~}", [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], "246"

  def_format_test :test_88, "~@{~#,#,v^~A~}", [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13], "246"

  def_format_test :test_89, "~@{~#,#,v^~A~}", [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14], "2468"

  def_format_test :test_90, "~@{~v,v^~A~}", [Fixnum::MAX + 1, Fixnum::MAX + 1, 1], ""

  def_format_test :test_91, "~@{~0,v,v^~A~}", [Fixnum::MAX + 1, Fixnum::MAX + 1, 1], ""

  def_format_test :test_92, "~@{~0,v,v^~A~}", [Fixnum::MAX + 1, Fixnum::MAX, 1], "1"

  def_format_test :test_93, "~@{~1,v^~A~}", [nil, 8, nil, 7, 0, 6, 1, 5], "876"

  def_format_test :test_94, "~@{~0,v^~A~}", [3, 8, 1, 7, 3, 6, nil, 5], "876"

  def_format_test :test_95, "~@{~1,2,v^~A~}", [0, 1, 0, 2, 0, 3, 3, 4], "123"

  def_format_test :test_96, "~@{~1,2,v^~A~}", [0, 1, 0, 2, 0, 3, nil, 4], "1234"

  def_format_test :test_97, "~@{~1,1,v^~A~}", [0, 1, 0, 2, 0, 3, nil, 4], "123"

  def_format_test :test_98, "~@{~'X^~A~}", [1, 2, 3], "123"

  def_format_test :test_99, "~@{~v,'X^~A~}", [0, 1, 'x', 2, nil, 3, 'X', 4, 0, 5], "123"

  def_format_test :test_100, "~@{~'X,v^~A~}", [0, 1, 'x', 2, nil, 3, 'X', 4, 0, 5], "123"

  def_format_test :test_101, "~@{~v,v^~A~}", [0, 2, 1, 'x', 'X', 2, 5, 'X', 3, 'y', 'y', 4, 1, 2, 5], "123"

  def_format_test :test_102, "~@{~',,',^~A~}", [1, 2, 3], ""

  def_format_test :test_103, "~@{~1,v,v^~A~}", ['a', nil, 0], "0"

  def_format_test :test_104, "~@{~v,1,v^~A~}", ['a', nil, 0], "0"

  def_format_test :test_105, "~@{~v,v,v^~A~}", ['a', 'a', nil, 0], ""

  # Inside ~:@{

  def_format_test :test_106, "~:@{~A~^~A~A~}", [[1], [2, 3, 4], [5, 6, 7, 8]], "1234567"

  def_format_test :test_107, "~@:{~A~0^~A~A~}", [[1], [2, 3, 4], [5, 6, 7, 8]], "125"

  def_format_test :test_108, "~:@{~#^~A~}", [[1], [2, 3, 4], [], [5, 6, 7, 8], []], "125"

  def_format_test :test_109, "~@:{~#^~A~#^~A~#^~A~#^~A~}", [[1], [2, 3, 4], [], [5, 6, 7, 8], []], "12345678"

  def_format_test :test_110, "~:@{~v^~A~}", [[1, 2, 3], [0], [2, 4], [0, 5], [1, 6, 7, 8]], "246"

  def_format_test :test_111, "~:@{~v^~A~}", [[nil], [nil, 1], [1, 2]], "12"

  def_format_test :test_112, "~:@{~v^~A~}", [['x', 1], ['y', 2], [0, 3], [1, 4]], "124"

  def_format_test :test_113, "~:@{~v,3^~A~}", [[1, 1], [2, 0], [3, 4], [5, 6]], "106"

  def_format_test :test_114, "~@:{~3,v^~A~}", [[1, 1], [2, 0], [3, 4], [5, 6]], "106"

  def_format_test :test_115, "~:@{~v,3^~A~}", [['x', 1]], "1"

  def_format_test :test_116, "~:@{~2,v^~A~}", [['x', 1]], "1"

  def_format_test :test_117, "~:@{~v,v^~A~}", [[1, 2, 0], [0, 1, 1], [1, 0, 2], [3, 3, 5], [4, 5, 6]], "0126"

  def_format_test :test_118, "~:@{~v,v^~A~}", [[1, 2, 0], ['a', 'A', 1], ['A', 'A', 2], [1, 2, 3]], "013"

  def_format_test :test_119, "~:@{~'x,3^~A~}", [[1]], "1"

  def_format_test :test_120, "~:@{~3,'x^~A~}", [[1]], "1"

  def_format_test :test_121, "~:@{~'x,'x^~A~}", [[1]], ""

  def_format_test :test_122, "~:@{~#,1^~A~}", [[1], [2, 10], [3, :a, :b], [4], [5, :x], [6], [7, 8]], "2357"

  def_format_test :test_123, "~:@{~1,#^~A~}", [[1], [2, 10], [3, :a, :b], [4], [5, :x], [6], [7, 8]], "2357"

  def_format_test :test_124, "~:@{~#,#^~A~}", [[1], [], [2, 10], [3, :a, :b], [4], [5, :x], [6], [7, 8]], ""

  def_format_test :test_125, "~:@{~0,v^~A~}", [[0, 1], [1, 2], [nil, 3], [2, 4]], "24"

  def_format_test :test_126, "~:@{~1,v^~A~}", [[0, 1], [1, 2], [nil, 3], [2, 4]], "134"

  def_format_test :test_127, "~:@{~1,1,1^~A~}", [[1], [2, 3], [4, 5, 6], [7, 8, 9, 0]], ""

  def_format_test :test_128, "~:@{~1,2,3^~A~}", [[1], [2, 3], [4, 5, 6], [7, 8, 9, 0]], ""

  def_format_test :test_129, "~:@{~1,2,1^~A~}", [[1], [2, 3], [4, 5, 6], [7, 8, 9, 0]], "1247"

  def_format_test :test_130, "~:@{~1,0,1^~A~}", [[1], [2, 3], [4, 5, 6], [7, 8, 9, 0]], "1247"

  def_format_test :test_131, "~:@{~3,2,1^~A~}", [[1], [2, 3], [4, 5, 6], [7, 8, 9, 0]], "1247"

  def_format_test :test_132, "~:@{~v,2,3^~A~}", [[1, 10], [2, 20], [3, 30], [4, 40]], "3040"

  def_format_test :test_133, "~:@{~1,v,3^~A~}", [[0, 7], [1, 10], [2, 20], [3, 30], [4, 40]], "740"

  def_format_test :test_134, "~:@{~1,2,v^~A~}", [[0, 0], [1, 10], [2, 20], [3, 30], [4, 40], [0, 50]], "01050"

  def_format_test :test_135, "~:@{~1,2,v^~A~}", [[nil, 0]], "0"

  def_format_test :test_136, "~:@{~#,3,3^~A~}", [[1], [2, 1], [3, 2, 1], [4, 3, 2, 1], [5, 4, 3, 2, 1]], "45"

  def_format_test :test_137, "~:@{~2,#,3^~A~}", [[1], [2, 1], [3, 2, 1], [4, 3, 2, 1], [5, 4, 3, 2, 1]], "145"

  def_format_test :test_138, "~:@{~0,3,#^~A~}", [[1], [2, 1], [3, 2, 1], [4, 3, 2, 1], [5, 4, 3, 2, 1]], "12"

  def_format_test :test_139, "~:@{~#,#,3^~A~}", [[1], [2, 1], [3, 2, 1], [4, 3, 2, 1], [5, 4, 3, 2, 1]], "45"

  def_format_test :test_140, "~:@{~3,#,#^~A~}", [[1], [2, 1], [3, 2, 1], [4, 3, 2, 1], [5, 4, 3, 2, 1]], "12"

  def_format_test :test_141, "~:@{~#,3,#^~A~}", [[1], [2, 1], [3, 2, 1], [4, 3, 2, 1], [5, 4, 3, 2, 1]], "1245"

  def_format_test :test_142, "~:@{~#,#,#^~A~}", [[1], [2, 1], [3, 2, 1], [4, 3, 2, 1], [5, 4, 3, 2, 1]], ""

  def_format_test :test_143, "~:@{~1,v,v^~A~}", [['a', nil, 0]], "0"

  def_format_test :test_144, "~:@{~v,1,v^~A~}", [['a', nil, 0]], "0"

  # ~:^ in ~:{

  def_format_test :test_145, "~:{~:^~A~}", [[]], ""

  def_format_test :test_146, "(~:{~A~:^,~})", [[[1], [2], [3]]], "(1,2,3)"

  def_format_test :test_147, "~:{~:^~A~}", [[[1], [2], [3], [4]]], "123"

  # arguments

  def_format_test :test_148, "~:{~0:^~A~}", [[[1], [2]]], ""

  def_format_test :test_149, "~:{~1:^~A~}", [[[1], [2]]], "12"

  def_format_test :test_150, "~:{~'X:^~A~}", [[[1], [2]]], "12"

  def_format_test :test_151, "~:{~v:^~A~}", [[[1, 8], [2, 3, 4], [3, 1], [0], [6, 7], [8, 10]]], "831"

  def_format_test :test_152, "~:{~V:^~A~}", [[['X', 1], [0, 2]]], "1"

  def_format_test :test_153, "~:{~#:^~A~}", [[[1], [2], [3, 4], [5, 6, 7], [], [8, 9, 10]]], "1235"

  def_format_test :test_154, "~:{~1,1:^~A~}", [[[], [1], [2, 3]]], ""

  def_format_test :test_155, "~:{~0,1:^~A~}", [[[1], [2, 3]]], "12"

  def_format_test :test_156, "~:{~v,1:^~A~}", [[[2, 3], [4, 5, 6], [0, 2], [1, 7], [9, 10]]], "352"

  def_format_test :test_157, "~:{~1,V:^~A~}", [[[2, 3], [4, 5, 6], [0, 2], [1, 7], [9, 10]]], "352"

  def_format_test :test_158, "~:{~V,v:^~A~}", [[[0, 1, 2], [1, 0, 3], [4, 4], [], [5, 6, 7]]], "23"

  def_format_test :test_159, "~:{~#,1:^~A~}", [[[2, 3, 4], [4, 5], [0], [1, 7], [9, 10]]], "24"

  def_format_test :test_160, "~:{~1,#:^~A~}", [[[2, 3, 4], [4, 5], [0], [1, 7], [9, 10]]], "24"

  def_format_test :test_161, "~:{~#,#:^~A~}", [[[]]], ""

  def_format_test :test_162, "~:{~#,#:^~A~}", [[[1]]], ""

  def_format_test :test_163, "~:{~#,v:^~A~}", [[[1, 2], [3, 4], [2, 5, 6], [1], [2]]], "245"

  def_format_test :test_164, "~:{~V,#:^~A~}", [[[0, 2], [1, 3, 4], [1, 3], [], [0, 7]]], "23"

  def_format_test :test_165, "~:{~'X,'Y:^~A~}", [[[1], [2]]], "12"

  def_format_test :test_166, "~:{~'X,'X:^~A~}", [[[1], [2]]], ""

  def_format_test :test_167, "~:{~1,2,3:^~A~}", [[[1], [2]]], ""

  def_format_test :test_168, "~:{~1,2,1:^~A~}", [[[1], [2]]], "12"

  def_format_test :test_169, "~:{~2,1,3:^~A~}", [[[1], [2]]], "12"

  def_format_test :test_170, "~:{~1,1,v:^~A~}", [[[0, 4], [nil, 1], [0, 5]]], "4"

  def_format_test :test_171, "~:{~v,2,2:^~A~}", [[[3, 4], [1, 1], [4, 5]]], "4"

  def_format_test :test_172, "~:{~1,v,2:^~A~}", [[[0, 2], [3, 4], [1, 1], [4, 5]]], "24"

  def_format_test :test_173, "~:{~V,v,3:^~A~}", [[[1, 4, 0], [2, 1, 7], [4, 4, 8, 0], [1, 2, 6], [9, 8, 0]]], "078"

  def_format_test :test_174, "~:{~v,2,v:^~A~}", [[[1, 1, 0], [3, 2, 5], [2, 1, 6], [1, 2, 0], [10, 11, 13]]], "056"

  def_format_test :test_175, "~:{~2,V,v:^~A~}", [[[1, 1, 0], [3, 2, 5], [2, 1, 6], [10, 11, 13], [0, 1, 0]]], "056"

  def_format_test :test_176, "~:{~v,v,V:^~A~}", [[[1, 2, 1, 0], [2, 1, 1, 4], [2, 3, 1, 6], [1, 2, 3], [0, 1, 0, 8]]], "046"

  def_format_test :test_177, "~:{~#,2,2:^~A~}", [[[1, 2, 3], [2, :X, :X], [0, :A, :B, :C, :D], [4, 5], [5, 7, 8, 9]]], "120"

  def_format_test :test_178, "~:{~2,#,3:^~A~}", [[[1], [2, 3, 4, 5], [3, 4], [4, 5, 6, 7, 8], []]], "12"

  def_format_test :test_179, "~:{~1,3,#:^~A~}", [[[1], [2, 3], [3, 4], [4, 5, 6], [5]]], "123"

  def_format_test :test_180, "~:{~#,#,2:^~A~}", [[[1, 2, 3], [2, :X, :X], [0, :A, :B, :C, :D], [4, 5], [5, 7, 8, 9]]], "120"

  def_format_test :test_181, "~:{~3,#,#:^~A~}", [[[1], [2, 3], [3, 4], [4, 5, 6], [5]]], "123"

  def_format_test :test_182, "~:{~#,2,#:^~A~}", [[[1, 2, 3], [2], [0, :A, :B, :C, :D], [4, 5], [5, 7, 8, 9]]], "120"

  def_format_test :test_183, "~:{~#,#,#:^~A~}", [[[1, 2, 3], [2], [0, :A, :B, :C, :D], [4, 5], [5, 7, 8, 9]]], ""

  # ~:^ in ~:@{

  def_format_test :test_184, "~:@{~:^~A~}", [], ""

  def_format_test :test_185, "(~:@{~A~:^,~})", [[1], [2], [3]], "(1,2,3)"

  def_format_test :test_186, "~:@{~:^~A~}", [[1], [2], [3], [4]], "123"

  def_format_test :test_187, "~:@{~0:^~A~}", [[1], [2]], ""

  def_format_test :test_188, "~:@{~1:^~A~}", [[1], [2]], "12"

  def_format_test :test_189, "~:@{~'X:^~A~}", [[1], [2]], "12"

  def_format_test :test_190, "~:@{~v:^~A~}", [[1, 8], [2, 3, 4], [3, 1], [0], [6, 7], [8, 10]], "831"

  def_format_test :test_191, "~:@{~V:^~A~}", [['X', 1], [0, 2]], "1"

  def_format_test :test_192, "~:@{~#:^~A~}", [[1], [2], [3, 4], [5, 6, 7], [], [8, 9, 10]], "1235"

  def_format_test :test_193, "~:@{~1,1:^~A~}", [[], [1], [2, 3]], ""

  def_format_test :test_194, "~:@{~0,1:^~A~}", [[1], [2, 3]], "12"

  def_format_test :test_195, "~:@{~v,1:^~A~}", [[2, 3], [4, 5, 6], [0, 2], [1, 7], [9, 10]], "352"

  def_format_test :test_196, "~:@{~1,V:^~A~}", [[2, 3], [4, 5, 6], [0, 2], [1, 7], [9, 10]], "352"

  def_format_test :test_197, "~:@{~V,v:^~A~}", [[0, 1, 2], [1, 0, 3], [4, 4], [], [5, 6, 7]], "23"

  def_format_test :test_198, "~:@{~#,1:^~A~}", [[2, 3, 4], [4, 5], [0], [1, 7], [9, 10]], "24"

  def_format_test :test_199, "~:@{~1,#:^~A~}", [[2, 3, 4], [4, 5], [0], [1, 7], [9, 10]], "24"

  def_format_test :test_200, "~:@{~#,#:^~A~}", [[]], ""

  def_format_test :test_201, "~:@{~#,#:^~A~}", [[1]], ""

  def_format_test :test_202, "~:@{~#,v:^~A~}", [[1, 2], [3, 4], [2, 5, 6], [1], [2]], "245"

  def_format_test :test_203, "~:@{~V,#:^~A~}", [[0, 2], [1, 3, 4], [1, 3], [], [0, 7]], "23"

  def_format_test :test_204, "~:@{~'X,'Y:^~A~}", [[1], [2]], "12"

  def_format_test :test_205, "~:@{~'X,'X:^~A~}", [[1], [2]], ""

  def_format_test :test_206, "~:@{~1,2,3:^~A~}", [[1], [2]], ""

  def_format_test :test_207, "~:@{~1,2,1:^~A~}", [[1], [2]], "12"

  def_format_test :test_208, "~:@{~2,1,3:^~A~}", [[1], [2]], "12"

  def_format_test :test_209, "~:@{~1,1,v:^~A~}", [[0, 4], [nil, 1], [0, 5]], "4"

  def_format_test :test_210, "~:@{~v,2,2:^~A~}", [[3, 4], [1, 1], [4, 5]], "4"

  def_format_test :test_211, "~:@{~1,v,2:^~A~}", [[0, 2], [3, 4], [1, 1], [4, 5]], "24"

  def_format_test :test_212, "~:@{~V,v,3:^~A~}", [[1, 4, 0], [2, 1, 7], [4, 4, 8, 0], [1, 2, 6], [9, 8, 0]], "078"

  def_format_test :test_213, "~:@{~v,2,v:^~A~}", [[1, 1, 0], [3, 2, 5], [2, 1, 6], [1, 2, 0], [10, 11, 13]], "056"

  def_format_test :test_214, "~:@{~2,V,v:^~A~}", [[1, 1, 0], [3, 2, 5], [2, 1, 6], [10, 11, 13], [0, 1, 0]], "056"

  def_format_test :test_215, "~:@{~v,v,V:^~A~}", [[1, 2, 1, 0], [2, 1, 1, 4], [2, 3, 1, 6], [1, 2, 3], [0, 1, 0, 8]], "046"

  def_format_test :test_216, "~:@{~#,2,2:^~A~}", [[1, 2, 3], [2, :X, :X], [0, :A, :B, :C, :D], [4, 5], [5, 7, 8, 9]], "120"

  def_format_test :test_217, "~:@{~2,#,3:^~A~}", [[1], [2, 3, 4, 5], [3, 4], [4, 5, 6, 7, 8], []], "12"

  def_format_test :test_218, "~:@{~1,3,#:^~A~}", [[1], [2, 3], [3, 4], [4, 5, 6], [5]], "123"

  def_format_test :test_219, "~:@{~#,#,2:^~A~}", [[1, 2, 3], [2, :X, :X], [0, :A, :B, :C, :D], [4, 5], [5, 7, 8, 9]], "120"

  def_format_test :test_220, "~:@{~3,#,#:^~A~}", [[1], [2, 3], [3, 4], [4, 5, 6], [5]], "123"

  def_format_test :test_221, "~:@{~#,2,#:^~A~}", [[1, 2, 3], [2], [0, :A, :B, :C, :D], [4, 5], [5, 7, 8, 9]], "120"

  def_format_test :test_222, "~:@{~#,#,#:^~A~}", [[1, 2, 3], [2], [0, :A, :B, :C, :D], [4, 5], [5, 7, 8, 9]], ""

  # ~^ inside ~?, ~@?

  def_format_test :test_223, "~AY~?X~A", [1, "~A~0^~A", [2, 4], 3], "1Y2X3"

  def_format_test :test_224, "~AY~?X~A", [1, "~A~^~A", [2], 3], "1Y2X3"

  def_format_test :test_225, "~AY~?X~A", [1, "~A~^~A~^~A", [2, 4], 3], "1Y24X3"

  def_format_test :test_226, "~A~?X~A", [1, "~{~^~A~}~AY~A", [[2, 3], 4, 5], 6], "1234Y5X6"

  def_format_test :test_227, "~AY~@?X~A", [1, "~A~0^~A", 2, 3, 4], "1Y2X3"

  def_format_test :test_228, "~A~@?X~A", [1, "~{~^~A~}~AY~A", [2, 3], 4, 5, 6], "1234Y5X6"

  # ~^ in ~[

  def_format_test :test_229, "~{~[X~;Y~;Z~;~0^~]~}", [[0, 1, 2, 3, 4]], "XYZ"

  def_format_test :test_230, "~{~[X~;Y~;Z~:;~0^~]~}", [[1, 0, 2, 8, 9, 10, 0]], "YXZ"

  def_format_test :test_231, "~{~[X~;Y~0^NO~;Z~;~^~]~}", [[0, 1, 2, 3, 4]], "XY"

  # ~^ in ~(

  def_format_test :test_232, "~{~(~C~C~0^~C~)W~}", [[?X, ?Y, ?Z, ?A]], "xy"

  def_format_test :test_233, "~{~:(~C~C~0^~C~)U~}", [[?X, ?Y, ?Z, ?A]], "Xy"

  def_format_test :test_234, "~{~@(~CA ~Cb ~0^~C~)V~}", [[?x, ?y, ?Z, ?A]], "Xa yb "

  def_format_test :test_235, "~{~@:(~CA ~Cb ~0^~C~)W~}", [[?x, ?Y, ?Z, ?A]], "XA YB "

#  def_format_test :test_236, "~:^", [], ""

#  def_format_test :test_237, "~{~:^~}", [], ""

#  def_format_test :test_238, "~:{~:^~}", [], ""
end
